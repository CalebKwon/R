
install.packages("RMeCab", repos = "http://rmecab.jp/R")
library(RMeCab)


m <- NgramDF(file.choose(), type = 1, pos =  c("–¼ŽŒ","Œ`—eŽŒ", "“®ŽŒ")) 

library(dplyr)
nrow (m)
head (m) # m %>% head #head (m)


m.df <- m %>% filter(Freq > 2)


install.packages("igraph")
library(igraph) 


m.g <- graph.data.frame(m.df)
E(m.g)$weight <- m.df[,3] 



tkplot(m.g, vertex.label =V(m.g)$name, edge.label =E(m.g)$weight , vertex.size = 23, vertex.color = "SkyBlue")




# Code05-02
m <- docNgram ("bungo", type = 0) 


colnames (m) <- c("?????????1","?????????2","?????????3","?????????4","?????????1","?????????2","?????????3","?????????4")


m <- m [ rownames(m) %in% c("[???-???]", "[???-???]", "[???-???]", "[???-???]", "[???-???]",  "[???-???]",  "[???-???]",  "[???-???]" ),  ]
m 

# Code05-03
dega <- data.frame(?????? = m[1,] ,?????? = m[3,],??????=c("?????????","?????????","?????????","?????????","?????????","?????????","?????????","?????????"))
library(ggplot2)

dega %>% ggplot(aes(x = ??????, y = ?????? , group=?????? ) ) + geom_point(aes(shape = ??????), size = 6) + scale_shape(solid = FALSE)# +scale_shape_manual(values=c(22,23))
# ggplot(dega, aes(x = ???, y = ??? , group=?????? ) ) + geom_point(aes(shape = ??????), size = 6) + scale_shape(solid = FALSE)

# Code05-04
m2 <- docNgram ("dazai", type = 0) 
colnames(m2) <- c("?????????1","?????????2","?????????3","?????????4",
                  "?????????1","?????????2","?????????3","?????????4",
                  "?????????1","?????????2","?????????3","????????? 4")

m2 <- m2 [ rownames(m2) %in% c("[???-???]", "[???-???]", "[???-???]", "[???-???]", "[???-???]",  "[???-???]",  "[???-???]",  "[???-???]" ) ,  ]


dega2 <- data.frame(?????? = m2[1,] , ?????? = m2[3,],??????=c("?????????","?????????","?????????","?????????",
                                                   "?????????","?????????","?????????","?????????",
                                                   "?????????","?????????","?????????","?????????"))
dega2

dega2 %>% ggplot(aes(x = ??????, y = ?????? , group=?????? ) ) + geom_point(aes(shape = ??????),size = 6) +scale_shape_manual(values=c(21,15,24))
# ggplot(dega2, aes(x = ???, y = ??? , group=?????? ) ) + geom_point(aes(shape = ??????), size = 6) +scale_shape_manual(values=c(21,15,24))

# Code05-05
m2.pca <- m2 %>% t %>% prcomp # m2.pca <- prcomp(t(m2))
m2.pca???%>% biplot (cex = 1.0) 

# Code05-06

round (m2.pca[[2]], 2) 